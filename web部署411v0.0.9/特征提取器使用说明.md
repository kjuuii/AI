# 🔍 特征提取器使用说明

## 概述

本项目提供了强大的特征提取功能，可以从电压和电流信号中提取33个不同的特征，并支持多种保存格式和分析工具集成。

## 文件说明

- `feature_extractor.py` - 核心特征提取模块（增强版）
- `feature_extraction.py` - Streamlit集成的特征提取页面
- `feature_extractor_demo.py` - 功能演示脚本

## 主要功能

### 1. 特征提取
从电压和电流数据中提取33个特征：
- **启动特征**: 峰值电流、峰值时间、启动斜率、启动加速度
- **稳态特征**: 均值、标准差、偏度、峰度、幅度等
- **频域特征**: 主频率、功率谱密度、频率分布
- **时域特征**: 峰值检测、自相关、滑动窗口统计
- **电压特征**: 电压统计量
- **功率特征**: 功率统计量和电压电流相关性

### 2. 数据保存功能
- **CSV格式**: 轻量级，易于处理
- **Excel格式**: 包含格式化，便于查看
- **带时间戳**: 自动生成唯一文件名
- **元数据保存**: 包含提取参数和特征信息

### 3. 分析工具集成
- **分类分析**: 导出用于机器学习分类的数据
- **回归分析**: 导出用于回归预测的数据
- **聚类分析**: 导出用于无监督学习的数据
- **自动脚本生成**: 创建现成的分析脚本模板

### 4. 网页跳转功能
- **本地应用**: Streamlit、Jupyter Notebook
- **在线平台**: Google Colab、Kaggle
- **文档资源**: Scikit-learn、Pandas文档
- **代码托管**: GitHub

## 使用方法

### 方法1: 交互式使用
```bash
python feature_extractor.py
```
按照提示选择操作：
1. 从Excel文件提取特征
2. 从CSV文件提取特征
3. 使用模拟数据测试
4. 查看特征说明
5. 退出

### 方法2: 编程使用
```python
from feature_extractor import process_data, save_features_to_file

# 加载数据
import pandas as pd
data = pd.read_excel('your_data.xlsx')

# 提取特征
features = process_data(
    data, 
    voltage_col='Voltage', 
    current_col='Current'
)

# 保存特征
save_features_to_file(features, file_format='csv')
```

### 方法3: Streamlit应用
在主应用中选择"特征提取"页面，享受图形化界面的便利。

### 方法4: 演示脚本
```bash
python feature_extractor_demo.py
```
运行完整的功能演示。

## 输出文件结构

```
output/
├── extracted_features_20250125_143022.csv    # 特征数据
├── classification_features_20250125_143022.csv  # 分类数据
├── regression_features_20250125_143022.csv     # 回归数据
├── clustering_features_20250125_143022.csv     # 聚类数据
└── *_metadata.json                             # 元数据文件

scripts/
├── classification_analysis_20250125_143022.py  # 分类脚本
├── regression_analysis_20250125_143022.py      # 回归脚本
├── clustering_analysis_20250125_143022.py      # 聚类脚本
└── general_analysis_20250125_143022.py         # 通用分析脚本
```

## 特征列表

| 序号 | 特征名称 | 描述 |
|------|----------|------|
| 1 | startup_peak | 启动峰值电流 |
| 2 | startup_peak_time | 启动峰值时间 |
| 3 | startup_acceleration | 启动加速度 |
| 4 | startup_slope | 启动斜率 |
| 5 | steady_mean | 稳态平均值 |
| 6 | steady_std | 稳态标准差 |
| 7 | steady_amplitude | 稳态幅度 |
| 8 | steady_iqr | 稳态四分位距 |
| 9 | steady_skew | 稳态偏度 |
| 10 | steady_kurtosis | 稳态峰度 |
| ... | ... | ... |
| 33 | voltage_current_corr | 电压电流相关性 |

## 参数配置

### 全局参数
- `SAMPLE_RATE`: 采样率 (默认: 625 Hz)
- `CURRENT_THRESHOLD`: 电流阈值 (默认: 0.5 A)

### 处理参数
- `window_size`: 数据窗口大小 (默认: 1875)
- `voltage_col`: 电压列名
- `current_col`: 电流列名

## 网页集成示例

### 打开Streamlit应用
```python
from feature_extractor import open_analysis_webpage
open_analysis_webpage('streamlit')
```

### 打开Google Colab
```python
open_analysis_webpage('colab')
```

### 打开文档
```python
open_analysis_webpage('sklearn_docs')  # Scikit-learn文档
open_analysis_webpage('pandas_docs')   # Pandas文档
```

## 生成的分析脚本

### 分类分析脚本
- 数据加载和预处理
- 特征标准化
- 随机森林分类器
- 模型评估和报告

### 回归分析脚本
- 数据加载和预处理
- 特征标准化
- 随机森林回归器
- 性能指标计算

### 聚类分析脚本
- 数据标准化
- K-means聚类
- 最佳聚类数确定
- 聚类结果可视化

## 注意事项

1. **数据格式**: 确保电压和电流数据为数值类型
2. **数据长度**: 建议至少100个数据点
3. **列名选择**: 正确指定电压和电流列名
4. **参数调整**: 根据实际信号特征调整阈值和窗口大小

## 故障排除

### 常见问题
1. **导入错误**: 确保安装了所需的Python包
2. **文件路径**: 检查文件路径是否正确
3. **数据格式**: 确保数据为数值格式，无缺失值
4. **权限问题**: 确保有写入输出目录的权限

### 依赖包
```bash
pip install pandas numpy scipy matplotlib seaborn scikit-learn openpyxl
```

## 联系支持

如有问题或建议，请通过以下方式联系：
- 在Streamlit应用中使用"用户反馈"功能
- 查看应用更新日志获取最新信息

---

**版本**: 1.0.0  
**更新时间**: 2025-01-25  
**兼容性**: Python 3.7+
